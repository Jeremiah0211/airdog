<?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml" 
	xmlns:services="no.airdog.services.*"
    xmlns:view="no.airdog.view.*"
	xmlns:adminView="no.airdog.view.admin.*"
    creationComplete="init()" styleName="MainView"
    width="100%" height="100%" minWidth="800" minHeight="500"
    paddingBottom="0" paddingLeft="0" paddingRight="0" paddingTop="0"
    verticalGap="0" horizontalGap="0">
	<mx:Script>
        <![CDATA[
        	import mx.core.UIComponent;
        	import no.airdog.controller.Navigasjon;
            import no.airdog.services.Components;
        	import no.airdog.model.Bruker;
            
            private function init():void
            {
				naviger(0);
            }
            
            private function naviger(barnNr:int):void
        	{
        		Navigasjon.naviger(barnNr);
        	}
        	
        	private function sok():void
			{
				naviger(1);
				meny.selectedChild = sokemeny;
				Components.instance.controller.sokHund(sokefelt.text);
			}
            
            private function innloggingSprettOppVindu():void
            {
            	init();
            	Components.instance.controller.loggUt();
            	Components.instance.controller.visLoggInnVindu(this);
            	sokefelt.text = '';
            }
            
            private function visStorHundeliste():void
			{
				Navigasjon.visStorHundeliste();
			}
			
			private function visLitenHundeliste():void
			{
				Navigasjon.visLitenHundeliste();
			}
			
			private function redigerBruker():void
			{
				var bruker:Bruker = new Bruker();
				bruker.epost = Components.instance.session.bruker.epost;
				bruker.fornavn = Components.instance.session.bruker.fornavn;
				bruker.etternavn = Components.instance.session.bruker.etternavn;
				bruker.passord = Components.instance.session.bruker.passord;
				bruker.superadmin = Components.instance.session.bruker.superadmin;
				
				Components.instance.controller.visRedigerBrukerVindu(UIComponent(this.parentApplication), bruker);
			}			
			
        ]]>
    </mx:Script>
	   	
	<mx:VBox id="topbar" styleName="TopBar" width="100%" 
		paddingBottom="0" paddingLeft="0" paddingRight="0" paddingTop="0" verticalGap="0" horizontalGap="0" verticalAlign="middle">
		<mx:ApplicationControlBar width="100%" styleName="applicationBar">
			<mx:Image source="@Embed(source='assets/logo/airdoglogo28clean.png')" buttonMode="true" click="naviger(0)"/>
			<mx:LinkButton label="AirDog" click="naviger(0)" width="66"/>
			
			<mx:HBox id="sokbar" styleName="sokBar" width="100%">
				<mx:TextInput id="sokefelt" enter="sok()" styleName="sokFelt" width="100%"/>
				<mx:LinkButton label="Søk" styleName="sokKnapp" icon="@Embed(source='assets/ikoner/magnifier.png')" click="sok()"/>
			</mx:HBox>
			
			
			<mx:Spacer width="100%"/>	
				<mx:LinkButton id="brukeren" label="{Components.instance.session.bruker.epost}"
					buttonMode="{Components.instance.session.bruker.rettigheter.redigerEgenBruker}"
					enabled="{Components.instance.session.bruker.rettigheter.redigerEgenBruker}"
					click="redigerBruker()" />
					<mx:Label text="|" />
					<mx:Label text="{Components.instance.session.bruker.sattKlubb}" paddingTop="3"/>
					<mx:Label text="|" />
					<mx:LinkButton label="Logg ut" click="innloggingSprettOppVindu()" icon="@Embed(source='assets/ikoner/door_open_out.png')" />
		</mx:ApplicationControlBar>
		
		<mx:HBox>
			<mx:LinkButton label="Søkemeny" icon="@Embed(source='assets/ikoner/reports.png')" 
				click="{meny.selectedChild = sokemeny}"
				visible="{Components.instance.session.bruker.rettigheter.lese}"/>
			<mx:LinkButton label="Rapporter" icon="@Embed(source='assets/ikoner/reports.png')" 
				click="{meny.selectedChild = rapportmeny}"
				visible="{Components.instance.session.bruker.rettigheter.lese}"/>
			<mx:LinkButton label="Admin" icon="@Embed(source='assets/ikoner/crown.png')" 
				click="{meny.selectedChild = adminmeny}"
				visible="{Components.instance.session.bruker.rettigheter.administrere}"/>
		</mx:HBox>

				
		<mx:HBox width="100%" backgroundColor="#FFFFFF" borderStyle="solid" borderThickness="1" borderColor="#a3a3a3" 
			paddingBottom="4" paddingTop="4" paddingLeft="4" paddingRight="4" verticalAlign="middle">
			
			<mx:ViewStack id="meny" width="100%"
				paddingBottom="0" paddingLeft="0" paddingRight="0" paddingTop="0" verticalGap="0" horizontalGap="0">
				
				<mx:HBox id="sokemeny" label="Søkemeny" width="100%">
					<mx:LinkButton id="sokeresultat" label="Søkeresultat" click="naviger(1)" styleName="UnderMeny" 
						icon="@Embed(source='assets/ikoner/dog_many.png')"
						enabled="{Components.instance.session.hundesokListe.provider != null ? true : false}"/>
		   			<mx:LinkButton label="Aktiv hundprofil" styleName="UnderMeny" click="naviger(2)"
		   				icon="@Embed(source='assets/ikoner/dog.png')" 
		   				enabled="{Components.instance.session.hundprofil != null ? true : false}"
		   				toolTip="{Components.instance.session.hundprofil != null ? Components.instance.session.hundprofil.navn : ''}"/>
					<!-- nedprioritert
					<mx:LinkButton label="Favoritthunder" enabled="false" styleName="UnderMeny" 
						icon="@Embed(source='assets/ikoner/star.png')"/>
					-->
				</mx:HBox>
				
				<mx:HBox id="rapportmeny" label="Rapporter" width="100%">					
					<mx:LinkButton label="Årsgjennomsnitt" styleName="UnderMeny" click="naviger(3)" 
						icon="@Embed(source='assets/ikoner/calendar_month.png')"/>
					<mx:LinkButton label="Fiktivt stamtre" styleName="UnderMeny" click="naviger(4)" 
						icon="@Embed(source='assets/ikoner/arrow_join_180.png')"/>
					<mx:LinkButton label="Rasens jaktresultater" styleName="UnderMeny" click="naviger(5)" 
						icon="@Embed(source='assets/ikoner/flag.png')"/>
					<mx:LinkButton label="Alle avlstall" styleName="UnderMeny" click="naviger(6)" />
					<mx:LinkButton label="Rankingliste" styleName="UnderMeny" click="naviger(7)" 
						icon="@Embed(source='assets/ikoner/crown.png')"/>
				</mx:HBox>
				
				<mx:HBox id="adminmeny" 
					enabled="{Components.instance.session.bruker.rettigheter.administrere}"
					label="Admin" width="100%">
					<mx:LinkButton 
						visible="{Components.instance.session.bruker.rettigheter.klubbRolleBrukerHandtering}" 
						includeInLayout="{Components.instance.session.bruker.rettigheter.klubbRolleBrukerHandtering}" 
						label="Brukere" click="naviger(8)" styleName="UnderMeny" icon="@Embed(source='assets/ikoner/users.png')"/>
					<mx:LinkButton
						visible="{Components.instance.session.bruker.rettigheter.rolleRettighetHandtering}" 
						includeInLayout="{Components.instance.session.bruker.rettigheter.rolleRettighetHandtering}" 
						label="Roller" click="naviger(9)" styleName="UnderMeny" 
						icon="@Embed(source='assets/ikoner/cards_address.png')"/>
			 		<mx:LinkButton 
			 			visible="{Components.instance.session.bruker.rettigheter.importerDatabase}" 
			 			includeInLayout="{Components.instance.session.bruker.rettigheter.importerDatabase}" 
			 			label="Last opp .DAT" click="naviger(10)" styleName="UnderMeny" 
			 			icon="@Embed(source='assets/ikoner/envelope__plus.png')"/>
			 		<mx:LinkButton 
			 			visible="{Components.instance.session.bruker.rettigheter.leggInnJaktprove}" 
			 			includeInLayout="{Components.instance.session.bruker.rettigheter.leggInnJaktprove}" 
			 			label="Legg inn jaktprøve" click="naviger(11)" styleName="UnderMeny" 
			 			icon="@Embed(source='assets/ikoner/report__plus.png')"/>
			 		<mx:LinkButton 
			 			visible="{Components.instance.session.bruker.rettigheter.administrereBackup}" 
			 			includeInLayout="{Components.instance.session.bruker.rettigheter.administrereBackup}" 
			 			label="Backup" click="naviger(12)" styleName="UnderMeny" 
			 			icon="@Embed(source='assets/ikoner/safe.png')"/>
				</mx:HBox>
			</mx:ViewStack>
		
			<mx:Image source="no/airdog/view/assets/ikoner/toggle.png" buttonMode="true"
				includeInLayout="{stack.selectedChild == hundesokview ? true : false}" click="visStorHundeliste()"/>
			<mx:Image source="no/airdog/view/assets/ikoner/toggle_collapse.png" buttonMode="true"
				includeInLayout="{stack.selectedChild == hundesokview ? true : false}" click="visLitenHundeliste()"/>	
		</mx:HBox>
	</mx:VBox>
	
	<mx:Spacer height="5" width="100%"/>
	
	<mx:ViewStack id="stack" width="100%" height="100%" 
		selectedIndex="{Components.instance.session.hovedNavigasjon.nr}">
	    <!--  0 -->	<view:Hjem id="hjemview"/>
	    <!--  1 -->	<view:HundeSok id="hundesokview"/>
	    <!--  2 -->	<view:HundeProfil id="hundprofilview"/>
	    <!--  3 -->	<view:Arsgjennomsnitt id="arsgjennomsnittview"/>
	    <!--  4 -->	<view:FiktivStamtre id="fiktivstamtreview"/>
	    <!--  5 -->	<view:RasensJaktresultaterAar id="rasensjaktresultateraarview"/>
	    <!--  6 -->	<view:AvlstallRapport id="avlstallRapport" />
		<!--  7 --> <view:Cup id="cup"/>
	    <!--  8 -->	<adminView:RolleBruker id="rollebrukerview"/>
	    <!--  9 -->	<adminView:RolleRettighet id="rollerettighetview"/>
	    <!-- 10 -->	<adminView:DatOpplastning id="datopplastningview"/>
	    <!-- 11 -->	<adminView:JaktproveVindu id="jaktprovevinduview"/>
	    <!-- 12 -->	<adminView:BackupVindu id="backupvinduview"/>
	</mx:ViewStack>
</mx:VBox>